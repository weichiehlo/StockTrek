let data = {
    "Meta Data": {
        "1. Information": "Intraday (5min) open, high, low, close prices and volume",
        "2. Symbol": "IBM",
        "3. Last Refreshed": "2020-04-15 16:00:00",
        "4. Interval": "5min",
        "5. Output Size": "Compact",
        "6. Time Zone": "US/Eastern"
    },
    "Time Series (5min)": {
        "2020-04-15 16:00:00": {
            "1. open": "118.2900",
            "2. high": "118.7600",
            "3. low": "118.2900",
            "4. close": "118.7000",
            "5. volume": "197421"
        },
        "2020-04-15 15:55:00": {
            "1. open": "118.7600",
            "2. high": "118.7900",
            "3. low": "118.2450",
            "4. close": "118.3000",
            "5. volume": "112873"
        },
        "2020-04-15 15:50:00": {
            "1. open": "118.7200",
            "2. high": "118.9200",
            "3. low": "118.7200",
            "4. close": "118.7500",
            "5. volume": "61443"
        },
        "2020-04-15 15:45:00": {
            "1. open": "118.7500",
            "2. high": "118.7800",
            "3. low": "118.5000",
            "4. close": "118.7300",
            "5. volume": "62907"
        },
        "2020-04-15 15:40:00": {
            "1. open": "118.6500",
            "2. high": "118.8100",
            "3. low": "118.6000",
            "4. close": "118.7500",
            "5. volume": "44269"
        },
        "2020-04-15 15:35:00": {
            "1. open": "118.7100",
            "2. high": "118.7800",
            "3. low": "118.5000",
            "4. close": "118.6300",
            "5. volume": "71615"
        },
        "2020-04-15 15:30:00": {
            "1. open": "118.7900",
            "2. high": "118.8400",
            "3. low": "118.5800",
            "4. close": "118.7300",
            "5. volume": "39159"
        },
        "2020-04-15 15:25:00": {
            "1. open": "118.8900",
            "2. high": "118.9600",
            "3. low": "118.7550",
            "4. close": "118.8300",
            "5. volume": "37088"
        },
        "2020-04-15 15:20:00": {
            "1. open": "118.8000",
            "2. high": "119.0000",
            "3. low": "118.7200",
            "4. close": "118.9300",
            "5. volume": "66548"
        },
        "2020-04-15 15:15:00": {
            "1. open": "118.9900",
            "2. high": "119.0200",
            "3. low": "118.7701",
            "4. close": "118.8000",
            "5. volume": "47376"
        },
        "2020-04-15 15:10:00": {
            "1. open": "119.4400",
            "2. high": "119.4600",
            "3. low": "118.9600",
            "4. close": "119.0000",
            "5. volume": "37461"
        },
        "2020-04-15 15:05:00": {
            "1. open": "119.6600",
            "2. high": "119.7000",
            "3. low": "119.3979",
            "4. close": "119.4500",
            "5. volume": "40859"
        },
        "2020-04-15 15:00:00": {
            "1. open": "119.2800",
            "2. high": "119.6700",
            "3. low": "119.2800",
            "4. close": "119.6500",
            "5. volume": "30026"
        },
        "2020-04-15 14:55:00": {
            "1. open": "119.6100",
            "2. high": "119.6100",
            "3. low": "119.2598",
            "4. close": "119.2650",
            "5. volume": "32637"
        },
        "2020-04-15 14:50:00": {
            "1. open": "119.6200",
            "2. high": "119.6900",
            "3. low": "119.4720",
            "4. close": "119.6100",
            "5. volume": "30083"
        },
        "2020-04-15 14:45:00": {
            "1. open": "119.7100",
            "2. high": "119.7200",
            "3. low": "119.5100",
            "4. close": "119.6021",
            "5. volume": "42449"
        },
        "2020-04-15 14:40:00": {
            "1. open": "119.6500",
            "2. high": "119.7700",
            "3. low": "119.5600",
            "4. close": "119.7200",
            "5. volume": "20131"
        },
        "2020-04-15 14:35:00": {
            "1. open": "119.6200",
            "2. high": "119.7300",
            "3. low": "119.4855",
            "4. close": "119.6900",
            "5. volume": "75559"
        },
        "2020-04-15 14:30:00": {
            "1. open": "119.5000",
            "2. high": "119.6400",
            "3. low": "119.4100",
            "4. close": "119.6000",
            "5. volume": "54363"
        },
        "2020-04-15 14:25:00": {
            "1. open": "119.4842",
            "2. high": "119.6200",
            "3. low": "119.4550",
            "4. close": "119.4740",
            "5. volume": "45188"
        },
        "2020-04-15 14:20:00": {
            "1. open": "119.1400",
            "2. high": "119.5300",
            "3. low": "119.1200",
            "4. close": "119.4700",
            "5. volume": "73305"
        },
        "2020-04-15 14:15:00": {
            "1. open": "118.8833",
            "2. high": "119.1900",
            "3. low": "118.8425",
            "4. close": "119.1700",
            "5. volume": "53867"
        },
        "2020-04-15 14:10:00": {
            "1. open": "118.7200",
            "2. high": "118.9550",
            "3. low": "118.7200",
            "4. close": "118.8850",
            "5. volume": "49776"
        },
        "2020-04-15 14:05:00": {
            "1. open": "118.4400",
            "2. high": "118.8100",
            "3. low": "118.4400",
            "4. close": "118.7100",
            "5. volume": "34085"
        },
        "2020-04-15 14:00:00": {
            "1. open": "118.4000",
            "2. high": "118.4800",
            "3. low": "118.2700",
            "4. close": "118.4100",
            "5. volume": "28545"
        },
        "2020-04-15 13:55:00": {
            "1. open": "118.5700",
            "2. high": "118.6800",
            "3. low": "118.3400",
            "4. close": "118.3800",
            "5. volume": "27117"
        },
        "2020-04-15 13:50:00": {
            "1. open": "118.4400",
            "2. high": "118.6505",
            "3. low": "118.3200",
            "4. close": "118.5700",
            "5. volume": "29340"
        },
        "2020-04-15 13:45:00": {
            "1. open": "118.1700",
            "2. high": "118.4700",
            "3. low": "118.1700",
            "4. close": "118.4200",
            "5. volume": "33452"
        },
        "2020-04-15 13:40:00": {
            "1. open": "118.3344",
            "2. high": "118.4900",
            "3. low": "118.1700",
            "4. close": "118.1800",
            "5. volume": "36549"
        },
        "2020-04-15 13:35:00": {
            "1. open": "118.4500",
            "2. high": "118.4500",
            "3. low": "118.2850",
            "4. close": "118.3400",
            "5. volume": "18722"
        },
        "2020-04-15 13:30:00": {
            "1. open": "118.6400",
            "2. high": "118.6400",
            "3. low": "118.3300",
            "4. close": "118.4600",
            "5. volume": "28105"
        },
        "2020-04-15 13:25:00": {
            "1. open": "118.7700",
            "2. high": "118.7700",
            "3. low": "118.5253",
            "4. close": "118.6400",
            "5. volume": "45394"
        },
        "2020-04-15 13:20:00": {
            "1. open": "118.6500",
            "2. high": "118.8700",
            "3. low": "118.5200",
            "4. close": "118.7712",
            "5. volume": "33273"
        },
        "2020-04-15 13:15:00": {
            "1. open": "118.1800",
            "2. high": "118.6200",
            "3. low": "118.1800",
            "4. close": "118.6100",
            "5. volume": "34871"
        },
        "2020-04-15 13:10:00": {
            "1. open": "118.0600",
            "2. high": "118.2900",
            "3. low": "117.9450",
            "4. close": "118.2000",
            "5. volume": "33636"
        },
        "2020-04-15 13:05:00": {
            "1. open": "117.8100",
            "2. high": "118.0705",
            "3. low": "117.7600",
            "4. close": "118.0500",
            "5. volume": "60549"
        },
        "2020-04-15 13:00:00": {
            "1. open": "117.9400",
            "2. high": "117.9600",
            "3. low": "117.7950",
            "4. close": "117.8300",
            "5. volume": "60593"
        },
        "2020-04-15 12:55:00": {
            "1. open": "117.9200",
            "2. high": "118.1000",
            "3. low": "117.8801",
            "4. close": "117.9600",
            "5. volume": "34319"
        },
        "2020-04-15 12:50:00": {
            "1. open": "117.9900",
            "2. high": "118.0500",
            "3. low": "117.8182",
            "4. close": "117.9200",
            "5. volume": "39372"
        },
        "2020-04-15 12:45:00": {
            "1. open": "117.6000",
            "2. high": "117.9999",
            "3. low": "117.5500",
            "4. close": "117.9800",
            "5. volume": "35741"
        },
        "2020-04-15 12:40:00": {
            "1. open": "117.7900",
            "2. high": "117.8770",
            "3. low": "117.5600",
            "4. close": "117.6000",
            "5. volume": "27278"
        },
        "2020-04-15 12:35:00": {
            "1. open": "117.7500",
            "2. high": "117.8800",
            "3. low": "117.6300",
            "4. close": "117.7899",
            "5. volume": "36167"
        },
        "2020-04-15 12:30:00": {
            "1. open": "117.4100",
            "2. high": "117.7800",
            "3. low": "117.3150",
            "4. close": "117.7600",
            "5. volume": "26909"
        },
        "2020-04-15 12:25:00": {
            "1. open": "117.1100",
            "2. high": "117.5100",
            "3. low": "117.1100",
            "4. close": "117.4500",
            "5. volume": "56511"
        },
        "2020-04-15 12:20:00": {
            "1. open": "117.1100",
            "2. high": "117.1800",
            "3. low": "117.0000",
            "4. close": "117.0900",
            "5. volume": "31289"
        },
        "2020-04-15 12:15:00": {
            "1. open": "117.0000",
            "2. high": "117.1100",
            "3. low": "116.7600",
            "4. close": "117.1000",
            "5. volume": "46556"
        },
        "2020-04-15 12:10:00": {
            "1. open": "117.2200",
            "2. high": "117.2200",
            "3. low": "116.9850",
            "4. close": "116.9987",
            "5. volume": "47103"
        },
        "2020-04-15 12:05:00": {
            "1. open": "117.2500",
            "2. high": "117.2850",
            "3. low": "117.0600",
            "4. close": "117.2202",
            "5. volume": "35353"
        },
        "2020-04-15 12:00:00": {
            "1. open": "117.2500",
            "2. high": "117.4782",
            "3. low": "117.1700",
            "4. close": "117.2600",
            "5. volume": "25284"
        },
        "2020-04-15 11:55:00": {
            "1. open": "117.1900",
            "2. high": "117.4000",
            "3. low": "117.1807",
            "4. close": "117.2450",
            "5. volume": "30729"
        },
        "2020-04-15 11:50:00": {
            "1. open": "117.0800",
            "2. high": "117.3872",
            "3. low": "117.0300",
            "4. close": "117.1900",
            "5. volume": "33500"
        },
        "2020-04-15 11:45:00": {
            "1. open": "117.3400",
            "2. high": "117.3900",
            "3. low": "117.0000",
            "4. close": "117.1070",
            "5. volume": "50062"
        },
        "2020-04-15 11:40:00": {
            "1. open": "117.6200",
            "2. high": "117.6400",
            "3. low": "117.3000",
            "4. close": "117.3700",
            "5. volume": "55843"
        },
        "2020-04-15 11:35:00": {
            "1. open": "117.3600",
            "2. high": "117.8550",
            "3. low": "117.3300",
            "4. close": "117.6700",
            "5. volume": "66436"
        },
        "2020-04-15 11:30:00": {
            "1. open": "116.9750",
            "2. high": "117.4052",
            "3. low": "116.9100",
            "4. close": "117.3800",
            "5. volume": "40075"
        },
        "2020-04-15 11:25:00": {
            "1. open": "117.1400",
            "2. high": "117.1500",
            "3. low": "116.9300",
            "4. close": "116.9800",
            "5. volume": "55960"
        },
        "2020-04-15 11:20:00": {
            "1. open": "117.3050",
            "2. high": "117.3924",
            "3. low": "116.9200",
            "4. close": "117.1700",
            "5. volume": "63863"
        },
        "2020-04-15 11:15:00": {
            "1. open": "117.3000",
            "2. high": "117.5300",
            "3. low": "117.2300",
            "4. close": "117.3200",
            "5. volume": "44181"
        },
        "2020-04-15 11:10:00": {
            "1. open": "117.2800",
            "2. high": "117.5900",
            "3. low": "117.2050",
            "4. close": "117.2900",
            "5. volume": "65172"
        },
        "2020-04-15 11:05:00": {
            "1. open": "118.1100",
            "2. high": "118.1459",
            "3. low": "117.5500",
            "4. close": "117.6700",
            "5. volume": "56085"
        },
        "2020-04-15 11:00:00": {
            "1. open": "118.1700",
            "2. high": "118.3050",
            "3. low": "118.0000",
            "4. close": "118.1200",
            "5. volume": "40312"
        },
        "2020-04-15 10:55:00": {
            "1. open": "118.3500",
            "2. high": "118.4100",
            "3. low": "118.0300",
            "4. close": "118.1700",
            "5. volume": "57226"
        },
        "2020-04-15 10:50:00": {
            "1. open": "118.2350",
            "2. high": "118.4400",
            "3. low": "118.2350",
            "4. close": "118.4400",
            "5. volume": "46932"
        },
        "2020-04-15 10:45:00": {
            "1. open": "117.9500",
            "2. high": "118.3800",
            "3. low": "117.9400",
            "4. close": "118.1700",
            "5. volume": "64864"
        },
        "2020-04-15 10:40:00": {
            "1. open": "117.7700",
            "2. high": "118.1000",
            "3. low": "117.7000",
            "4. close": "117.9500",
            "5. volume": "61741"
        },
        "2020-04-15 10:35:00": {
            "1. open": "117.9150",
            "2. high": "117.9900",
            "3. low": "117.7000",
            "4. close": "117.8000",
            "5. volume": "52739"
        },
        "2020-04-15 10:30:00": {
            "1. open": "117.8800",
            "2. high": "118.0550",
            "3. low": "117.6000",
            "4. close": "117.9200",
            "5. volume": "75486"
        },
        "2020-04-15 10:25:00": {
            "1. open": "118.1237",
            "2. high": "118.3300",
            "3. low": "117.7900",
            "4. close": "117.8994",
            "5. volume": "71672"
        },
        "2020-04-15 10:20:00": {
            "1. open": "118.6100",
            "2. high": "118.7500",
            "3. low": "118.1200",
            "4. close": "118.1250",
            "5. volume": "52084"
        },
        "2020-04-15 10:15:00": {
            "1. open": "118.9838",
            "2. high": "119.2100",
            "3. low": "118.5200",
            "4. close": "118.6291",
            "5. volume": "35070"
        },
        "2020-04-15 10:10:00": {
            "1. open": "118.8900",
            "2. high": "119.2400",
            "3. low": "118.8400",
            "4. close": "119.0603",
            "5. volume": "46013"
        },
        "2020-04-15 10:05:00": {
            "1. open": "119.4475",
            "2. high": "119.4500",
            "3. low": "118.8313",
            "4. close": "118.9300",
            "5. volume": "66740"
        },
        "2020-04-15 10:00:00": {
            "1. open": "118.8350",
            "2. high": "119.6900",
            "3. low": "118.7800",
            "4. close": "119.4500",
            "5. volume": "67600"
        },
        "2020-04-15 09:55:00": {
            "1. open": "119.3400",
            "2. high": "119.4400",
            "3. low": "118.7100",
            "4. close": "118.8450",
            "5. volume": "81867"
        },
        "2020-04-15 09:50:00": {
            "1. open": "119.3800",
            "2. high": "119.5000",
            "3. low": "119.0900",
            "4. close": "119.3500",
            "5. volume": "39572"
        },
        "2020-04-15 09:45:00": {
            "1. open": "119.7000",
            "2. high": "119.7800",
            "3. low": "119.2100",
            "4. close": "119.3600",
            "5. volume": "47101"
        },
        "2020-04-15 09:40:00": {
            "1. open": "119.8900",
            "2. high": "119.9800",
            "3. low": "119.5000",
            "4. close": "119.7000",
            "5. volume": "49521"
        },
        "2020-04-15 09:35:00": {
            "1. open": "119.1200",
            "2. high": "120.1852",
            "3. low": "119.0000",
            "4. close": "119.8191",
            "5. volume": "208402"
        },
        "2020-04-14 16:00:00": {
            "1. open": "123.9400",
            "2. high": "124.0000",
            "3. low": "123.6400",
            "4. close": "123.8300",
            "5. volume": "186561"
        },
        "2020-04-14 15:55:00": {
            "1. open": "124.0900",
            "2. high": "124.1900",
            "3. low": "123.6400",
            "4. close": "123.9400",
            "5. volume": "122775"
        },
        "2020-04-14 15:50:00": {
            "1. open": "123.8400",
            "2. high": "124.1100",
            "3. low": "123.7800",
            "4. close": "124.0600",
            "5. volume": "62753"
        },
        "2020-04-14 15:45:00": {
            "1. open": "123.9200",
            "2. high": "124.0550",
            "3. low": "123.7700",
            "4. close": "123.8350",
            "5. volume": "69376"
        },
        "2020-04-14 15:40:00": {
            "1. open": "123.8300",
            "2. high": "123.9300",
            "3. low": "123.7600",
            "4. close": "123.9200",
            "5. volume": "40713"
        },
        "2020-04-14 15:35:00": {
            "1. open": "123.8800",
            "2. high": "123.9800",
            "3. low": "123.8300",
            "4. close": "123.8500",
            "5. volume": "41055"
        },
        "2020-04-14 15:30:00": {
            "1. open": "123.7600",
            "2. high": "123.8700",
            "3. low": "123.7100",
            "4. close": "123.8600",
            "5. volume": "48342"
        },
        "2020-04-14 15:25:00": {
            "1. open": "123.7600",
            "2. high": "123.7800",
            "3. low": "123.5900",
            "4. close": "123.7100",
            "5. volume": "25403"
        },
        "2020-04-14 15:20:00": {
            "1. open": "123.7100",
            "2. high": "123.9100",
            "3. low": "123.5200",
            "4. close": "123.8200",
            "5. volume": "30820"
        },
        "2020-04-14 15:15:00": {
            "1. open": "123.7150",
            "2. high": "123.7900",
            "3. low": "123.5750",
            "4. close": "123.7600",
            "5. volume": "24625"
        },
        "2020-04-14 15:10:00": {
            "1. open": "123.7700",
            "2. high": "123.7900",
            "3. low": "123.5700",
            "4. close": "123.7000",
            "5. volume": "20241"
        },
        "2020-04-14 15:05:00": {
            "1. open": "124.0400",
            "2. high": "124.0500",
            "3. low": "123.7700",
            "4. close": "123.7900",
            "5. volume": "17090"
        },
        "2020-04-14 15:00:00": {
            "1. open": "124.0100",
            "2. high": "124.1600",
            "3. low": "123.9305",
            "4. close": "124.0800",
            "5. volume": "39470"
        },
        "2020-04-14 14:55:00": {
            "1. open": "124.0000",
            "2. high": "124.2000",
            "3. low": "123.9900",
            "4. close": "124.0200",
            "5. volume": "29013"
        },
        "2020-04-14 14:50:00": {
            "1. open": "123.8700",
            "2. high": "124.0500",
            "3. low": "123.8700",
            "4. close": "123.9900",
            "5. volume": "27307"
        },
        "2020-04-14 14:45:00": {
            "1. open": "124.0400",
            "2. high": "124.1300",
            "3. low": "123.8400",
            "4. close": "123.8800",
            "5. volume": "30737"
        },
        "2020-04-14 14:40:00": {
            "1. open": "123.9200",
            "2. high": "124.0700",
            "3. low": "123.9014",
            "4. close": "124.0200",
            "5. volume": "23212"
        },
        "2020-04-14 14:35:00": {
            "1. open": "124.0000",
            "2. high": "124.0300",
            "3. low": "123.8300",
            "4. close": "123.9320",
            "5. volume": "22462"
        },
        "2020-04-14 14:30:00": {
            "1. open": "124.1600",
            "2. high": "124.1800",
            "3. low": "123.9100",
            "4. close": "123.9500",
            "5. volume": "14020"
        },
        "2020-04-14 14:25:00": {
            "1. open": "124.1800",
            "2. high": "124.2561",
            "3. low": "124.0900",
            "4. close": "124.1947",
            "5. volume": "20530"
        },
        "2020-04-14 14:20:00": {
            "1. open": "123.8440",
            "2. high": "124.2000",
            "3. low": "123.8200",
            "4. close": "124.2000",
            "5. volume": "39253"
        },
        "2020-04-14 14:15:00": {
            "1. open": "123.7550",
            "2. high": "123.8800",
            "3. low": "123.7060",
            "4. close": "123.8700",
            "5. volume": "18656"
        }
    }
}

let d = new Date();
let marketInactive = false;
let time


// If the market is closed
if(d.getHours()>15){
    marketInactive = true;
}



//add zero padding
let month  = (d.getMonth()+1).toString();
console.log(month)
if(month.length === 1){
    month = "0" + month
} 

let minutes  = (Math.floor(d.getMinutes()/5)*5).toString();
if(minutes.length === 1){
    minutes = "0" + minutes
} 



//If the market is closed then set the time to 4PM else set the closest time, in a 5 minutes interval
if(marketInactive){
    time = d.getFullYear()+"-"+month+"-"+d.getDate()+" "+"16:00:00"
}else{
    time = d.getFullYear()+"-"+month+"-"+d.getDate()+" "+d.getHours()+":"+minutes+":00"
}

console.log(time)
console.log(data["Time Series (5min)"][time])


let getlatestAvg = ()=>{
    let high = data["Time Series (5min)"][time]['2. high']
    let low = data["Time Series (5min)"][time]['3. low']
    return (parseFloat(high)+parseFloat(low))/2
}

let getAllAvg = ()=>{

    let intervals = Object.keys(data["Time Series (5min)"]);
    let total = intervals.reduce((a, interval)=>{
        let high = data["Time Series (5min)"][interval]['2. high']
        let low = data["Time Series (5min)"][interval]['3. low']
        return a + (parseFloat(high)+parseFloat(low))/2
    }
    ,0)
    return total/intervals.length
}

console.log(getlatestAvg())
console.log(getAllAvg())




